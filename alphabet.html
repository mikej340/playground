<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Letter ⇄ Number Trainer (A↔1…Z↔26)</title>
<style>
  :root{
    --bg:#0f1115; --card:#171a21; --ink:#e8ecf1; --muted:#a9b4c2;
    --brand:#6aa1ff; --ok:#38d39f; --bad:#ff6b6b; --warn:#ffd166;
    --ring: rgba(106,161,255,.5);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#0b0d12, #12151c 35%, #0f1115);
    color:var(--ink); font:500 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    display:flex; align-items:center; justify-content:center; padding:24px;
  }
  .app{
    width:100%; max-width:820px; background:var(--card); border-radius:16px; padding:22px;
    box-shadow:0 10px 25px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.02);
    border:1px solid rgba(255,255,255,.06)
  }
  header{display:flex; gap:14px; align-items:center; justify-content:space-between; flex-wrap:wrap}
  h1{font-size:20px; margin:0; letter-spacing:.3px}
  .sub{color:var(--muted); font-size:13px}
  .controls{display:flex; gap:10px; flex-wrap:wrap}
  select, button, input{
    background:#0e1117; color:var(--ink); border:1px solid rgba(255,255,255,.12);
    border-radius:10px; padding:10px 12px; font:600 14px inherit;
  }
  button{cursor:pointer; transition:transform .05s ease, background .2s}
  button.primary{background:var(--brand); border-color:transparent; color:#071224}
  button:focus, select:focus, input:focus{outline:none; box-shadow:0 0 0 3px var(--ring)}
  .row{display:grid; grid-template-columns:1fr; gap:18px; margin-top:18px}
  .quiz{
    display:grid; gap:14px; grid-template-columns: 1fr; align-items:center; justify-items:center;
    padding:18px; background:#0e1117; border-radius:14px; border:1px solid rgba(255,255,255,.08)
  }
  .prompt{
    font-weight:800; letter-spacing:1px; font-size:64px; line-height:1; padding:4px 16px;
  }
  .prompt.badge{border-radius:12px; background:rgba(255,255,255,.03)}
  .io{
    display:flex; gap:10px; width:100%; max-width:520px;
  }
  .io input{
    flex:1; height:48px; font-size:18px; background:#0b0e13; border-radius:10px;
  }
  .io button{height:48px}
  .stats{
    display:grid; grid-template-columns:repeat(6, minmax(0,1fr)); gap:8px; width:100%; max-width:720px;
  }
  .stat{
    background:#0e1117; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px; text-align:center;
  }
  .stat .k{font-size:12px; color:var(--muted)}
  .stat .v{font-size:20px; font-weight:800}
  .feedback{min-height:26px; color:var(--muted)}
  .feedback .ok{color:var(--ok)} .feedback .bad{color:var(--bad)} .feedback .hint{color:var(--warn)}
  .flash-ok{animation:flashOK .35s ease}
  .flash-bad{animation:flashBad .4s ease}
  @keyframes flashOK{ from{box-shadow:0 0 0 0 rgba(56,211,159,.0)} 50%{box-shadow:0 0 0 10px rgba(56,211,159,.15)} to{box-shadow:0 0 0 0 rgba(56,211,159,0)}}
  @keyframes flashBad{ 20%{transform:translateX(-4px)} 40%{transform:translateX(4px)} 60%{transform:translateX(-2px)} 80%{transform:translateX(2px)}}
  .footer{display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:12px; margin-top:12px}
  .kbd{font:600 12px ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; background:#0e1117; border:1px solid rgba(255,255,255,.12); padding:2px 6px; border-radius:6px}
  .pill{padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.12); background:#0e1117}
  .muted{color:var(--muted)}
  @media (max-width:560px){
    .stats{grid-template-columns:repeat(3, minmax(0,1fr))}
    .prompt{font-size:48px}
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-label="Letter to Number Trainer">
    <header>
      <div>
        <h1>Letter ⇄ Number Trainer</h1>
        <div class="sub">Drill A↔1 with instant feedback, streaks, and timed sprints.</div>
      </div>
      <div class="controls" aria-label="Controls">
        <label class="muted" for="mode">Mode</label>
        <select id="mode" aria-label="Question mode">
          <option value="L2N">Letter → Number (A → 1)</option>
          <option value="N2L">Number → Letter (1 → A)</option>
          <option value="MIX">Mixed</option>
        </select>
        <button id="practiceBtn" class="">Practice</button>
        <button id="timedBtn" class="primary">60s Sprint</button>
      </div>
    </header>

    <div class="row">
      <section class="quiz" aria-labelledby="promptLabel">
        <div id="promptLabel" class="muted" aria-hidden="true">Prompt</div>
        <div id="prompt" class="prompt badge" aria-live="polite">—</div>

        <div class="io">
          <label class="visually-hidden" for="answer">Your answer</label>
          <input id="answer" inputmode="text" autocomplete="off" spellcheck="false" placeholder="Type answer… (Enter)" aria-label="Type your answer and press Enter" />
          <button id="submitBtn" class="">Submit <span class="kbd">Enter</span></button>
        </div>

        <div id="feedback" class="feedback" aria-live="polite"></div>

        <div class="stats" aria-label="Stats">
          <div class="stat"><div class="k">Mode</div><div class="v" id="statMode">L→N</div></div>
          <div class="stat"><div class="k">Correct</div><div class="v" id="statCorrect">0</div></div>
          <div class="stat"><div class="k">Total</div><div class="v" id="statTotal">0</div></div>
          <div class="stat"><div class="k">Accuracy</div><div class="v" id="statAcc">—</div></div>
          <div class="stat"><div class="k">Streak</div><div class="v" id="statStreak">0</div></div>
          <div class="stat"><div class="k">Time</div><div class="v" id="statTime">∞</div></div>
        </div>
      </section>

      <div class="footer">
        <div>
          <span class="pill">Shortcuts: <span class="kbd">Space</span> start/next · <span class="kbd">Enter</span> submit · <span class="kbd">M</span> switch mode</span>
        </div>
        <div>
          Best (60s): <span id="bestL2N" class="pill">L→N: —</span>
          <span id="bestN2L" class="pill">N→L: —</span>
          <span id="bestMIX" class="pill">Mix: —</span>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // ---------- Mapping helpers ----------
  const A_CODE = 'A'.charCodeAt(0);
  const toLetter = (n) => (n>=1 && n<=26) ? String.fromCharCode(A_CODE + n - 1) : null;
  const toNumber = (ch) => {
    if (!ch || typeof ch !== 'string') return null;
    const c = ch.trim().toUpperCase();
    if (c.length !== 1) return null;
    const code = c.charCodeAt(0) - A_CODE + 1;
    return (code>=1 && code<=26) ? code : null;
  };

  // ---------- State ----------
  const el = (id) => document.getElementById(id);
  const promptEl = el('prompt');
  const answerEl = el('answer');
  const feedbackEl = el('feedback');
  const statModeEl = el('statMode');
  const statCorrectEl = el('statCorrect');
  const statTotalEl = el('statTotal');
  const statAccEl = el('statAcc');
  const statStreakEl = el('statStreak');
  const statTimeEl = el('statTime');
  const modeSel = el('mode');
  const practiceBtn = el('practiceBtn');
  const timedBtn = el('timedBtn');
  const submitBtn = el('submitBtn');

  const bestEls = {
    L2N: el('bestL2N'),
    N2L: el('bestN2L'),
    MIX: el('bestMIX'),
  };

  let mode = 'L2N';           // 'L2N' | 'N2L' | 'MIX'
  let running = false;
  let timed = false;
  let timeLeft = Infinity;
  let tick = null;

  let currentQ = null;        // { type:'L'|'N', value:number|letter, answer:string }
  let correct = 0, total = 0, streak = 0;

  // ---------- Best scores (localStorage) ----------
  const LS_KEY = 'alpha-mapper-bests';
  const bests = (() => {
    try {
      const saved = JSON.parse(localStorage.getItem(LS_KEY) || '{}');
      return { L2N: saved.L2N || 0, N2L: saved.N2L || 0, MIX: saved.MIX || 0 };
    } catch { return { L2N:0, N2L:0, MIX:0 }; }
  })();
  const saveBests = () => localStorage.setItem(LS_KEY, JSON.stringify(bests));
  const renderBests = () => {
    bestEls.L2N.textContent = `L→N: ${bests.L2N || '—'}`;
    bestEls.N2L.textContent = `N→L: ${bests.N2L || '—'}`;
    bestEls.MIX.textContent = `Mix: ${bests.MIX || '—'}`;
  };
  renderBests();

  // ---------- UI helpers ----------
  const setModeLabel = () => {
    statModeEl.textContent = mode === 'L2N' ? 'L→N' : mode === 'N2L' ? 'N→L' : 'Mix';
  };
  const setTime = (t) => { statTimeEl.textContent = (t===Infinity) ? '∞' : `${t}s`; };
  const setFeedback = (html, cls='') => {
    feedbackEl.innerHTML = html || '';
    feedbackEl.className = `feedback ${cls}`;
  };
  const resetStats = () => {
    correct = 0; total = 0; streak = 0; timeLeft = timed ? 60 : Infinity;
    statCorrectEl.textContent = '0';
    statTotalEl.textContent = '0';
    statAccEl.textContent = '—';
    statStreakEl.textContent = '0';
    setTime(timeLeft);
  };
  const updateStats = () => {
    statCorrectEl.textContent = String(correct);
    statTotalEl.textContent = String(total);
    const acc = total ? Math.round((correct/total)*100) : null;
    statAccEl.textContent = acc===null ? '—' : `${acc}%`;
    statStreakEl.textContent = String(streak);
  };
  const flash = (ok) => {
    promptEl.classList.remove('flash-ok','flash-bad');
    void promptEl.offsetWidth; // reflow
    promptEl.classList.add(ok ? 'flash-ok' : 'flash-bad');
  };

  // ---------- Question generation ----------
  const nextInt = (lo, hi) => Math.floor(Math.random()*(hi-lo+1)) + lo;
  const makeQuestion = () => {
    if (mode === 'L2N') {
      const n = nextInt(1,26); const L = toLetter(n);
      return { type:'L', value:L, answer:String(n) };
    } else if (mode === 'N2L') {
      const n = nextInt(1,26);
      return { type:'N', value:n, answer:toLetter(n) };
    } else {
      // MIX: randomly choose which side to ask
      const askL = Math.random() < 0.5;
      const n = nextInt(1,26); const L = toLetter(n);
      return askL ? { type:'L', value:L, answer:String(n) } : { type:'N', value:n, answer:L };
    }
  };

  const renderQuestion = () => {
    currentQ = makeQuestion();
    promptEl.textContent = currentQ.type === 'L' ? currentQ.value : String(currentQ.value);
    setFeedback('');
    answerEl.value = '';
    answerEl.focus();
  };

  // ---------- Checking answers ----------
  const norm = (s) => (s ?? '').trim().toUpperCase();
  const check = () => {
    if (!running || !currentQ) return;
    const raw = answerEl.value;
    const expected = currentQ.answer.toUpperCase();
    const got = norm(raw);

    let isCorrect = false;
    if (currentQ.type === 'L') { // expecting number 1..26
      const asNum = Number(got);
      isCorrect = Number.isInteger(asNum) && String(asNum) === expected;
    } else { // type N: expecting letter
      isCorrect = got === expected;
    }

    total++;
    if (isCorrect) {
      correct++; streak++;
      setFeedback(`<span class="ok">✓ Correct</span>`, 'ok');
      flash(true);
      updateStats();
      renderQuestion();
    } else {
      streak = 0;
      const shown = currentQ.type === 'L'
        ? `${currentQ.value} → ${expected}`
        : `${currentQ.value} → ${expected}`;
      setFeedback(`<span class="bad">✕</span> Correct: <strong>${shown}</strong>`, 'bad');
      flash(false);
      updateStats();
      // keep same question until answered correctly (optional). For flow, move on:
      renderQuestion();
    }
  };

  // ---------- Sessions ----------
  const start = (isTimed) => {
    timed = isTimed;
    running = true;
    resetStats();
    setModeLabel();
    if (timed) {
      if (tick) clearInterval(tick);
      timeLeft = 60; setTime(timeLeft);
      tick = setInterval(() => {
        if (!running) return;
        timeLeft--; setTime(timeLeft);
        if (timeLeft <= 0) {
          clearInterval(tick); finish();
        }
      }, 1000);
    } else {
      if (tick) { clearInterval(tick); tick = null; }
    }
    renderQuestion();
    setFeedback(`<span class="hint">Go for it! Type your answer and press <span class="kbd">Enter</span>.</span>`);
  };

  const finish = () => {
    running = false;
    setTime(0);
    // Save bests for timed only
    if (timed) {
      if (correct > (bests[mode]||0)) {
        bests[mode] = correct; saveBests(); renderBests();
        setFeedback(`<span class="ok">New best!</span> ${correct} correct in 60s.`);
      } else {
        setFeedback(`Time! You got <strong>${correct}</strong>. Best: ${bests[mode]||0}`);
      }
    } else {
      setFeedback(`Session ended. Score: <strong>${correct}/${total}</strong> (${statAccEl.textContent}).`);
    }
    promptEl.textContent = '—';
  };

  // ---------- Events ----------
  modeSel.addEventListener('change', (e) => {
    mode = modeSel.value;
    setModeLabel();
    if (!running) setFeedback(`Mode set to <strong>${statModeEl.textContent}</strong>. Press <span class="kbd">Space</span> or use buttons to start.`);
    answerEl.focus();
  });

  practiceBtn.addEventListener('click', () => start(false));
  timedBtn.addEventListener('click', () => start(true));
  submitBtn.addEventListener('click', check);
  answerEl.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') { e.preventDefault(); check(); }
  });

  document.addEventListener('keydown', (e) => {
    if (['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) {
      if (e.key === 'Escape') { answerEl.blur(); }
    }
    if (e.key.toLowerCase() === 'm') {
      const order = ['L2N','N2L','MIX'];
      const idx = order.indexOf(mode);
      mode = order[(idx+1)%order.length];
      modeSel.value = mode; setModeLabel();
      setFeedback(`Mode → <strong>${statModeEl.textContent}</strong>`);
    }
    if (e.code === 'Space') {
      e.preventDefault();
      if (!running) start(false); else renderQuestion();
    }
  });

  // Initial
  setModeLabel(); setFeedback(`Choose a mode and press <span class="kbd">Space</span> to start, or try a <strong>60s Sprint</strong>.`);
  answerEl.value = '';
  // Accessibility nicety: visually hidden helper
  const vh = document.createElement('style');
  vh.innerHTML = `.visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap}`;
  document.head.appendChild(vh);
})();
</script>
</body>
</html>
